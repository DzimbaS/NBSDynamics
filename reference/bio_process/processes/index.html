
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>Processes - NBSDynamics documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="deltares" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#biophysical-processes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="NBSDynamics documentation" class="md-header__button md-logo" aria-label="NBSDynamics documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NBSDynamics documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Processes
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="deltares" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/Deltares/NBSDynamics/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    deltares/nbsdynamics
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      NBSDynamics documentation
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../changelog/" class="md-tabs__link">
      Changelog
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../guides/contribute/" class="md-tabs__link">
        Guides
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../core/" class="md-tabs__link md-tabs__link--active">
        Reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="NBSDynamics documentation" class="md-nav__button md-logo" aria-label="NBSDynamics documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8z"/></svg>

    </a>
    NBSDynamics documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Deltares/NBSDynamics/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    deltares/nbsdynamics
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        NBSDynamics documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/contribute/" class="md-nav__link">
        How to contribute to NBSDynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/run_simulation/" class="md-nav__link">
        How to run a simulation in NBSDynamics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        Core
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Bio process
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Bio process" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Bio process
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Processes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Processes
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#biophysical-processes" class="md-nav__link">
    Biophysical processes
  </a>
  
    <nav class="md-nav" aria-label="Biophysical processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calcification" class="md-nav__link">
    Calcification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.calcification.Calcification" class="md-nav__link">
    Calcification
  </a>
  
    <nav class="md-nav" aria-label="Calcification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.calcification.Calcification.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.calcification.Calcification.calcification_rate" class="md-nav__link">
    calcification_rate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dislodgement" class="md-nav__link">
    Dislodgement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement" class="md-nav__link">
    Dislodgement
  </a>
  
    <nav class="md-nav" aria-label="Dislodgement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.colony_shape_factor" class="md-nav__link">
    colony_shape_factor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.csf_formula" class="md-nav__link">
    csf_formula()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.dislodgement_criterion" class="md-nav__link">
    dislodgement_criterion()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.dislodgement_mechanical_threshold" class="md-nav__link">
    dislodgement_mechanical_threshold()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.dmt_formula" class="md-nav__link">
    dmt_formula()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.partial_dislodgement" class="md-nav__link">
    partial_dislodgement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow" class="md-nav__link">
    Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow" class="md-nav__link">
    Flow
  </a>
  
    <nav class="md-nav" aria-label="Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.thermal_boundary_layer" class="md-nav__link">
    thermal_boundary_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.uc_matrix" class="md-nav__link">
    uc_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.uw_matrix" class="md-nav__link">
    uw_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.velocities" class="md-nav__link">
    velocities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.velocity_boundary_layer" class="md-nav__link">
    velocity_boundary_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.wave_attenuation" class="md-nav__link">
    wave_attenuation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.wave_current" class="md-nav__link">
    wave_current()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#light" class="md-nav__link">
    Light
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light" class="md-nav__link">
    Light
  </a>
  
    <nav class="md-nav" aria-label="Light">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.base_light" class="md-nav__link">
    base_light()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.biomass" class="md-nav__link">
    biomass()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.light_spreading" class="md-nav__link">
    light_spreading()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.rep_light" class="md-nav__link">
    rep_light()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.side_correction" class="md-nav__link">
    side_correction()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#morphology" class="md-nav__link">
    Morphology
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology" class="md-nav__link">
    Morphology
  </a>
  
    <nav class="md-nav" aria-label="Morphology">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.delta_volume" class="md-nav__link">
    delta_volume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.ratio_update" class="md-nav__link">
    ratio_update()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.rf_optimal" class="md-nav__link">
    rf_optimal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.rp_optimal" class="md-nav__link">
    rp_optimal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.rs_optimal" class="md-nav__link">
    rs_optimal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#photosynthesis" class="md-nav__link">
    Photosynthesis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis" class="md-nav__link">
    Photosynthesis
  </a>
  
    <nav class="md-nav" aria-label="Photosynthesis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.flow_dependency" class="md-nav__link">
    flow_dependency()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.light_dependency" class="md-nav__link">
    light_dependency()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.photo_rate" class="md-nav__link">
    photo_rate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.thermal_dependency" class="md-nav__link">
    thermal_dependency()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#population-states" class="md-nav__link">
    Population states
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates" class="md-nav__link">
    PopulationStates
  </a>
  
    <nav class="md-nav" aria-label="PopulationStates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates.pop_states_t" class="md-nav__link">
    pop_states_t()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates.pop_states_xy" class="md-nav__link">
    pop_states_xy()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recruitment" class="md-nav__link">
    Recruitment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment" class="md-nav__link">
    Recruitment
  </a>
  
    <nav class="md-nav" aria-label="Recruitment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment.recruited" class="md-nav__link">
    recruited()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment.spawning" class="md-nav__link">
    spawning()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature" class="md-nav__link">
    Temperature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature" class="md-nav__link">
    Temperature
  </a>
  
    <nav class="md-nav" aria-label="Temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature.coral_temperature" class="md-nav__link">
    coral_temperature()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" data-md-state="indeterminate" type="checkbox" id="__nav_4_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Common
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Common" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/common/" class="md-nav__link">
        Common
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" data-md-state="indeterminate" type="checkbox" id="__nav_4_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Coral
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Coral" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Coral
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../coral/coral/" class="md-nav__link">
        Coral
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" data-md-state="indeterminate" type="checkbox" id="__nav_4_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Hydrodynamics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hydrodynamics" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Hydrodynamics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hydrodynamics/hydromodels/" class="md-nav__link">
        Hydromodels
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" data-md-state="indeterminate" type="checkbox" id="__nav_4_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_6">
          Output
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Output" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Output
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../output/output/" class="md-nav__link">
        Output
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_7" data-md-state="indeterminate" type="checkbox" id="__nav_4_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_7">
          Simulation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Simulation" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          Simulation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulation/simulation/" class="md-nav__link">
        Simulation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#biophysical-processes" class="md-nav__link">
    Biophysical processes
  </a>
  
    <nav class="md-nav" aria-label="Biophysical processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calcification" class="md-nav__link">
    Calcification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.calcification.Calcification" class="md-nav__link">
    Calcification
  </a>
  
    <nav class="md-nav" aria-label="Calcification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.calcification.Calcification.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.calcification.Calcification.calcification_rate" class="md-nav__link">
    calcification_rate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dislodgement" class="md-nav__link">
    Dislodgement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement" class="md-nav__link">
    Dislodgement
  </a>
  
    <nav class="md-nav" aria-label="Dislodgement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.colony_shape_factor" class="md-nav__link">
    colony_shape_factor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.csf_formula" class="md-nav__link">
    csf_formula()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.dislodgement_criterion" class="md-nav__link">
    dislodgement_criterion()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.dislodgement_mechanical_threshold" class="md-nav__link">
    dislodgement_mechanical_threshold()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.dmt_formula" class="md-nav__link">
    dmt_formula()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.partial_dislodgement" class="md-nav__link">
    partial_dislodgement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.dislodgment.Dislodgement.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow" class="md-nav__link">
    Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow" class="md-nav__link">
    Flow
  </a>
  
    <nav class="md-nav" aria-label="Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.thermal_boundary_layer" class="md-nav__link">
    thermal_boundary_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.uc_matrix" class="md-nav__link">
    uc_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.uw_matrix" class="md-nav__link">
    uw_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.velocities" class="md-nav__link">
    velocities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.velocity_boundary_layer" class="md-nav__link">
    velocity_boundary_layer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.wave_attenuation" class="md-nav__link">
    wave_attenuation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.flow.Flow.wave_current" class="md-nav__link">
    wave_current()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#light" class="md-nav__link">
    Light
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light" class="md-nav__link">
    Light
  </a>
  
    <nav class="md-nav" aria-label="Light">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.base_light" class="md-nav__link">
    base_light()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.biomass" class="md-nav__link">
    biomass()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.light_spreading" class="md-nav__link">
    light_spreading()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.rep_light" class="md-nav__link">
    rep_light()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.light.Light.side_correction" class="md-nav__link">
    side_correction()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#morphology" class="md-nav__link">
    Morphology
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology" class="md-nav__link">
    Morphology
  </a>
  
    <nav class="md-nav" aria-label="Morphology">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.delta_volume" class="md-nav__link">
    delta_volume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.ratio_update" class="md-nav__link">
    ratio_update()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.rf_optimal" class="md-nav__link">
    rf_optimal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.rp_optimal" class="md-nav__link">
    rp_optimal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.rs_optimal" class="md-nav__link">
    rs_optimal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.morphology.Morphology.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#photosynthesis" class="md-nav__link">
    Photosynthesis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis" class="md-nav__link">
    Photosynthesis
  </a>
  
    <nav class="md-nav" aria-label="Photosynthesis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.flow_dependency" class="md-nav__link">
    flow_dependency()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.light_dependency" class="md-nav__link">
    light_dependency()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.photo_rate" class="md-nav__link">
    photo_rate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.photosynthesis.Photosynthesis.thermal_dependency" class="md-nav__link">
    thermal_dependency()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#population-states" class="md-nav__link">
    Population states
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates" class="md-nav__link">
    PopulationStates
  </a>
  
    <nav class="md-nav" aria-label="PopulationStates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates.pop_states_t" class="md-nav__link">
    pop_states_t()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.population_states.PopulationStates.pop_states_xy" class="md-nav__link">
    pop_states_xy()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recruitment" class="md-nav__link">
    Recruitment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment" class="md-nav__link">
    Recruitment
  </a>
  
    <nav class="md-nav" aria-label="Recruitment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment.recruited" class="md-nav__link">
    recruited()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment.spawning" class="md-nav__link">
    spawning()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.recruitment.Recruitment.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temperature" class="md-nav__link">
    Temperature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature" class="md-nav__link">
    Temperature
  </a>
  
    <nav class="md-nav" aria-label="Temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature.__init__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.core.bio_process.temperature.Temperature.coral_temperature" class="md-nav__link">
    coral_temperature()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Deltares/NBSDynamics/edit/master/docs/reference/bio_process/processes.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Processes</h1>
                
                <h2 id="biophysical-processes">Biophysical processes<a class="headerlink" href="#biophysical-processes" title="Permanent link">&para;</a></h2>
<h3 id="calcification">Calcification<a class="headerlink" href="#calcification" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.calcification.Calcification" class="doc doc-heading">
        <code>Calcification</code>



<a href="#src.core.bio_process.calcification.Calcification" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Calcification rate.</p>




  <div class="doc doc-children">




  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.calcification.Calcification.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pfd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_proc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Kd0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_max</span><span class="o">=</span><span class="mf">1.5707963267948966</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">Cf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wcAngle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">numericTheta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">maxiter_k</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">maxiter_aw</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">K0</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">ap</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.6089</span><span class="p">,</span> <span class="n">iota</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ik_max</span><span class="o">=</span><span class="mf">372.32</span><span class="p">,</span> <span class="n">pm_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">betaI</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span> <span class="n">betaP</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">Icomp</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Ea</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">8.31446261815324</span><span class="p">,</span> <span class="n">k_var</span><span class="o">=</span><span class="mf">2.45</span><span class="p">,</span> <span class="n">nn</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">pfd_min</span><span class="o">=</span><span class="mf">0.68886964</span><span class="p">,</span> <span class="n">ucr</span><span class="o">=</span><span class="mf">0.5173</span><span class="p">,</span> <span class="n">r_growth</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">r_recovery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">r_mortality</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">r_bleaching</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">gC</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">omegaA0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">0.14587415</span><span class="p">,</span> <span class="n">kappaA</span><span class="o">=</span><span class="mf">0.66236107</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prop_form</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_plate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">prop_plate_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space</span><span class="o">=</span><span class="mf">0.35355339059327373</span><span class="p">,</span> <span class="n">prop_space_light</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rho_c</span><span class="o">=</span><span class="mf">1600.0</span><span class="p">,</span> <span class="n">sigma_t</span><span class="o">=</span><span class="mf">200000.0</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rho_w</span><span class="o">=</span><span class="mf">1025.0</span><span class="p">,</span> <span class="n">no_larvae</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="n">prob_settle</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">d_larvae</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#src.core.bio_process.calcification.Calcification.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Calcification rate.</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/calcification.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;Calcification rate.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ad</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.calcification.Calcification.calcification_rate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">calcification_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span></code>


<a href="#src.core.bio_process.calcification.Calcification.calcification_rate" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Calcification rate.</p>
<p>:param coral: coral animal
:param omega: aragonite saturation state</p>
<p>:type coral: Coral
:type omega: float, list, tuple, numpy.ndarray</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/calcification.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">calcification_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calcification rate.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param omega: aragonite saturation state</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type omega: float, list, tuple, numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">aragonite_dependency</span><span class="p">(</span><span class="n">calcification_object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Aragonite dependency.&quot;&quot;&quot;</span>
        <span class="n">calcification_object</span><span class="o">.</span><span class="n">ad</span> <span class="o">=</span> <span class="p">(</span><span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">omega0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">kappaA</span> <span class="o">+</span> <span class="n">omega</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">omega0</span>
        <span class="p">)</span>
        <span class="n">calcification_object</span><span class="o">.</span><span class="n">ad</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span>
            <span class="n">calcification_object</span><span class="o">.</span><span class="n">ad</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span>
        <span class="p">)</span>

    <span class="n">aragonite_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">gC</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">pop_states</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ad</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">photo_rate</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>

<h3 id="dislodgement">Dislodgement<a class="headerlink" href="#dislodgement" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.dislodgment.Dislodgement" class="doc doc-heading">
        <code>Dislodgement</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a href="#src.core.bio_process.dislodgment.Dislodgement" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Dislodgement due to storm conditions.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.dislodgment.Dislodgement.colony_shape_factor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">colony_shape_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.dislodgment.Dislodgement.colony_shape_factor" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Colony Shape Factor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>coral</code></td>
        <td><code>Coral</code></td>
        <td><p>Coral animal.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/dislodgment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">colony_shape_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Colony Shape Factor.</span>

<span class="sd">    Args:</span>
<span class="sd">        coral (Coral): Coral animal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">csf</span> <span class="o">=</span> <span class="n">CoralOnly</span><span class="p">()</span><span class="o">.</span><span class="n">in_space</span><span class="p">(</span>
        <span class="n">coral</span><span class="o">=</span><span class="n">coral</span><span class="p">,</span>
        <span class="n">function</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">csf_formula</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">dc</span><span class="p">,</span> <span class="n">coral</span><span class="o">.</span><span class="n">hc</span><span class="p">,</span> <span class="n">coral</span><span class="o">.</span><span class="n">bc</span><span class="p">,</span> <span class="n">coral</span><span class="o">.</span><span class="n">tc</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>











  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.dislodgment.Dislodgement.csf_formula" class="doc doc-heading">
<code class="highlight language-python"><span class="n">csf_formula</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">hc</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">tc</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.core.bio_process.dislodgment.Dislodgement.csf_formula" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Determine the Colony Shape Factor.</p>
<p>:param dc: diameter coral plate [m]
:param hc: coral height [m]
:param bc: diameter coral base [m]
:param tc: thickness coral plate [m]</p>
<p>:type dc: float, numpy.ndarray
:type hc: float, numpy.ndarray
:type bc: float, numpy.ndarray
:type tc: float, numpy.ndarray</p>
<p>:return: colony shape factor
:rtype: float, numpy.ndarray</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/dislodgment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">csf_formula</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">hc</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">tc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine the Colony Shape Factor.</span>

<span class="sd">    :param dc: diameter coral plate [m]</span>
<span class="sd">    :param hc: coral height [m]</span>
<span class="sd">    :param bc: diameter coral base [m]</span>
<span class="sd">    :param tc: thickness coral plate [m]</span>

<span class="sd">    :type dc: float, numpy.ndarray</span>
<span class="sd">    :type hc: float, numpy.ndarray</span>
<span class="sd">    :type bc: float, numpy.ndarray</span>
<span class="sd">    :type tc: float, numpy.ndarray</span>

<span class="sd">    :return: colony shape factor</span>
<span class="sd">    :rtype: float, numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># arms of moment</span>
    <span class="n">arm_top</span> <span class="o">=</span> <span class="n">hc</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">tc</span>
    <span class="n">arm_bottom</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">hc</span> <span class="o">-</span> <span class="n">tc</span><span class="p">)</span>
    <span class="c1"># area of moment</span>
    <span class="n">area_top</span> <span class="o">=</span> <span class="n">dc</span> <span class="o">*</span> <span class="n">tc</span>
    <span class="n">area_bottom</span> <span class="o">=</span> <span class="n">bc</span> <span class="o">*</span> <span class="p">(</span><span class="n">hc</span> <span class="o">-</span> <span class="n">tc</span><span class="p">)</span>
    <span class="c1"># integral</span>
    <span class="n">integral</span> <span class="o">=</span> <span class="n">arm_top</span> <span class="o">*</span> <span class="n">area_top</span> <span class="o">+</span> <span class="n">arm_bottom</span> <span class="o">*</span> <span class="n">area_bottom</span>
    <span class="c1"># colony shape factor</span>
    <span class="k">return</span> <span class="mf">16.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">bc</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">integral</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.dislodgment.Dislodgement.dislodgement_criterion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dislodgement_criterion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.dislodgment.Dislodgement.dislodgement_criterion" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Dislodgement criterion. Returns boolean (array).</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/dislodgment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dislodgement_criterion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dislodgement criterion. Returns boolean (array).</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dislodgement_mechanical_threshold</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">colony_shape_factor</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dmt</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csf</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.dislodgment.Dislodgement.dislodgement_mechanical_threshold" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dislodgement_mechanical_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.dislodgment.Dislodgement.dislodgement_mechanical_threshold" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Dislodgement Mechanical Threshold.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>coral</code></td>
        <td><code>Coral</code></td>
        <td><p>Coral animal.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/dislodgment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dislodgement_mechanical_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dislodgement Mechanical Threshold.</span>

<span class="sd">    Args:</span>
<span class="sd">        coral (Coral): Coral animal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># # check input</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">um</span><span class="p">,</span> <span class="s2">&quot;__iter__&quot;</span><span class="p">):</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">um</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">coral</span><span class="o">.</span><span class="n">um</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">um</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">um</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">um</span><span class="p">)</span>

    <span class="c1"># # calculations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dmt</span> <span class="o">=</span> <span class="mf">1e20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">um</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dmt</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">um</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dmt_formula</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span> <span class="n">coral</span><span class="o">.</span><span class="n">um</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">um</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>








  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.dislodgment.Dislodgement.dmt_formula" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dmt_formula</span><span class="p">(</span><span class="n">constants</span><span class="p">,</span> <span class="n">flow_velocity</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.core.bio_process.dislodgment.Dislodgement.dmt_formula" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Determine the Dislodgement Mechanical Threshold.</p>
<p>:param flow_velocity: depth-averaged flow velocity
:type flow_velocity: float, numpy.ndarray</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/dislodgment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">dmt_formula</span><span class="p">(</span><span class="n">constants</span><span class="p">,</span> <span class="n">flow_velocity</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine the Dislodgement Mechanical Threshold.</span>

<span class="sd">    :param flow_velocity: depth-averaged flow velocity</span>
<span class="sd">    :type flow_velocity: float, numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">constants</span><span class="o">.</span><span class="n">sigma_t</span> <span class="o">/</span> <span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">rho_w</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">Cd</span> <span class="o">*</span> <span class="n">flow_velocity</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.dislodgment.Dislodgement.partial_dislodgement" class="doc doc-heading">
<code class="highlight language-python"><span class="n">partial_dislodgement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">survival_coefficient</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span></code>


<a href="#src.core.bio_process.dislodgment.Dislodgement.partial_dislodgement" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Percentage surviving storm event.</p>
<p>:param coral: coral animal
:param survival_coefficient: percentage of partial survival, defualts to 1</p>
<p>:type coral: Coral
:type survival_coefficient: float, optional</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/dislodgment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">partial_dislodgement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">survival_coefficient</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Percentage surviving storm event.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param survival_coefficient: percentage of partial survival, defualts to 1</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type survival_coefficient: float, optional</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Rewrite such that the distinction between an array or a float is well build in.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">survival</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">dc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Dislodgement</span><span class="o">.</span><span class="n">dislodgement_criterion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">survival</span> <span class="o">=</span> <span class="n">survival_coefficient</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dmt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">csf</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">survival</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dislodged</span> <span class="o">=</span> <span class="n">Dislodgement</span><span class="o">.</span><span class="n">dislodgement_criterion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">survival</span><span class="p">[</span><span class="n">dislodged</span><span class="p">]</span> <span class="o">=</span> <span class="n">survival_coefficient</span> <span class="o">*</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dmt</span><span class="p">[</span><span class="n">dislodged</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">csf</span><span class="p">[</span><span class="n">dislodged</span><span class="p">]</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>








  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.dislodgment.Dislodgement.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">survival_coefficient</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span></code>


<a href="#src.core.bio_process.dislodgment.Dislodgement.update" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Update morphology due to storm damage.</p>
<p>:param coral: coral animal
:param survival_coefficient: percentage of partial survival, defualts to 1</p>
<p>:type coral: Coral
:type survival_coefficient: float, optional</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/dislodgment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">survival_coefficient</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update morphology due to storm damage.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param survival_coefficient: percentage of partial survival, defualts to 1</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type survival_coefficient: float, optional</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># # partial dislodgement</span>
    <span class="n">Dislodgement</span><span class="o">.</span><span class="n">partial_dislodgement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">survival_coefficient</span><span class="p">)</span>
    <span class="c1"># # update</span>
    <span class="c1"># ulation states</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[:,</span> <span class="n">s</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">survival</span>
    <span class="c1"># morphology</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">update_coral_volume</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">volume</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">survival</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>

<h3 id="flow">Flow<a class="headerlink" href="#flow" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.flow.Flow" class="doc doc-heading">
        <code>Flow</code>



<a href="#src.core.bio_process.flow.Flow" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Flow micro-environment.</p>




  <div class="doc doc-children">




  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.flow.Flow.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u_current</span><span class="p">,</span> <span class="n">u_wave</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">peak_period</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pfd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_proc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Kd0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_max</span><span class="o">=</span><span class="mf">1.5707963267948966</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">Cf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wcAngle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">numericTheta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">maxiter_k</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">maxiter_aw</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">K0</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">ap</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.6089</span><span class="p">,</span> <span class="n">iota</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ik_max</span><span class="o">=</span><span class="mf">372.32</span><span class="p">,</span> <span class="n">pm_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">betaI</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span> <span class="n">betaP</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">Icomp</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Ea</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">8.31446261815324</span><span class="p">,</span> <span class="n">k_var</span><span class="o">=</span><span class="mf">2.45</span><span class="p">,</span> <span class="n">nn</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">pfd_min</span><span class="o">=</span><span class="mf">0.68886964</span><span class="p">,</span> <span class="n">ucr</span><span class="o">=</span><span class="mf">0.5173</span><span class="p">,</span> <span class="n">r_growth</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">r_recovery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">r_mortality</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">r_bleaching</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">gC</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">omegaA0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">0.14587415</span><span class="p">,</span> <span class="n">kappaA</span><span class="o">=</span><span class="mf">0.66236107</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prop_form</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_plate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">prop_plate_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space</span><span class="o">=</span><span class="mf">0.35355339059327373</span><span class="p">,</span> <span class="n">prop_space_light</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rho_c</span><span class="o">=</span><span class="mf">1600.0</span><span class="p">,</span> <span class="n">sigma_t</span><span class="o">=</span><span class="mf">200000.0</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rho_w</span><span class="o">=</span><span class="mf">1025.0</span><span class="p">,</span> <span class="n">no_larvae</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="n">prob_settle</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">d_larvae</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#src.core.bio_process.flow.Flow.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>:param u_current: current flow velocity [m s-1]
:param u_wave: wave flow velocity [m s-1]
:param h: water depth [m]
:param peak_period: peak wave period [s]</p>
<p>:type u_current: float, list, tuple, numpy.ndarray
:type u_wave: float, list, tuple, numpy.ndarray
:type h: float, list, tuple, numpy.ndarray
:type peak_period: float, list, tuple, numpy.ndarray</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/flow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">u_current</span><span class="p">,</span>
    <span class="n">u_wave</span><span class="p">,</span>
    <span class="n">h</span><span class="p">,</span>
    <span class="n">peak_period</span><span class="p">,</span>
    <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(),</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param u_current: current flow velocity [m s-1]</span>
<span class="sd">    :param u_wave: wave flow velocity [m s-1]</span>
<span class="sd">    :param h: water depth [m]</span>
<span class="sd">    :param peak_period: peak wave period [s]</span>

<span class="sd">    :type u_current: float, list, tuple, numpy.ndarray</span>
<span class="sd">    :type u_wave: float, list, tuple, numpy.ndarray</span>
<span class="sd">    :type h: float, list, tuple, numpy.ndarray</span>
<span class="sd">    :type peak_period: float, list, tuple, numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_reshape</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uc</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2array</span><span class="p">(</span><span class="n">u_current</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">uw</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2array</span><span class="p">(</span><span class="n">u_wave</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s2">&quot;space&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Tp</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2array</span><span class="p">(</span><span class="n">peak_period</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">u_current</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">u_wave</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.flow.Flow.thermal_boundary_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">thermal_boundary_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.flow.Flow.thermal_boundary_layer" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Thermal boundary layer.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/flow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">thermal_boundary_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thermal boundary layer.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">tme</span><span class="p">:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_boundary_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">delta_t</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">alpha</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">nu</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-attribute">



<h4 id="src.core.bio_process.flow.Flow.uc_matrix" class="doc doc-heading">
<code class="highlight language-python"><span class="n">uc_matrix</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#src.core.bio_process.flow.Flow.uc_matrix" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reshaped current flow velocity.</p>
    </div>

  </div>





  <div class="doc doc-object doc-attribute">



<h4 id="src.core.bio_process.flow.Flow.uw_matrix" class="doc doc-heading">
<code class="highlight language-python"><span class="n">uw_matrix</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#src.core.bio_process.flow.Flow.uw_matrix" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Reshaped wave flow velocity.</p>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.flow.Flow.velocities" class="doc doc-heading">
<code class="highlight language-python"><span class="n">velocities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">in_canopy</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span></code>


<a href="#src.core.bio_process.flow.Flow.velocities" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>In-canopy flow velocities, and depth-averaged flow velocities.</p>
<p>:param coral: coral animal
:param in_canopy: determine in-canopy flow (or depth-averaged), defaults to True</p>
<p>:type coral: Coral
:type in_canopy: bool, optional</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/flow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">velocities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">in_canopy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;In-canopy flow velocities, and depth-averaged flow velocities.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param in_canopy: determine in-canopy flow (or depth-averaged), defaults to True</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type in_canopy: bool, optional</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
        <span class="n">alpha_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uw</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">alpha_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">in_canopy</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">:</span>
                <span class="n">alpha_w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave_attenuation</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span>
                    <span class="n">coral</span><span class="o">.</span><span class="n">dc_rep</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">coral</span><span class="o">.</span><span class="n">hc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">coral</span><span class="o">.</span><span class="n">ac</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">uw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Tp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">wac_type</span><span class="o">=</span><span class="s2">&quot;wave&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">alpha_c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave_attenuation</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span>
                    <span class="n">coral</span><span class="o">.</span><span class="n">dc_rep</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">coral</span><span class="o">.</span><span class="n">hc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">coral</span><span class="o">.</span><span class="n">ac</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">uc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="mf">1e3</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">wac_type</span><span class="o">=</span><span class="s2">&quot;current&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">ucm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave_current</span><span class="p">(</span><span class="n">alpha_w</span><span class="p">,</span> <span class="n">alpha_c</span><span class="p">)</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">um</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wave_current</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">ucm</span> <span class="o">=</span> <span class="mi">9999</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">space</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.flow.Flow.velocity_boundary_layer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">velocity_boundary_layer</span><span class="p">(</span><span class="n">constants</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.core.bio_process.flow.Flow.velocity_boundary_layer" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Velocity boundary layer.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/flow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">velocity_boundary_layer</span><span class="p">(</span><span class="n">constants</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Velocity boundary layer.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">boundary_layer</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">cf</span><span class="p">,</span> <span class="n">ucm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Thickness velocity boundary layer.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">rd</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cf</span><span class="p">)</span> <span class="o">*</span> <span class="n">ucm</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CoralOnly</span><span class="p">()</span><span class="o">.</span><span class="n">in_space</span><span class="p">(</span>
        <span class="n">coral</span><span class="o">=</span><span class="n">coral</span><span class="p">,</span>
        <span class="n">function</span><span class="o">=</span><span class="n">boundary_layer</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">rd</span><span class="p">,</span> <span class="n">constants</span><span class="o">.</span><span class="n">nu</span><span class="p">,</span> <span class="n">constants</span><span class="o">.</span><span class="n">Cf</span><span class="p">,</span> <span class="n">coral</span><span class="o">.</span><span class="n">ucm</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.flow.Flow.wave_attenuation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wave_attenuation</span><span class="p">(</span><span class="n">constants</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">velocity</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">wac_type</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.core.bio_process.flow.Flow.wave_attenuation" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Wave-attenuation coefficient.</p>
<p>:param diameter: representative coral diameter [m]
:param height: coral height [m]
:param distance: axial distance [m]
:param velocity: flow velocity [m s-1]
:param period: wave period [s]
:param depth: water depth [m]
:param wac_type: type of wave-attenuation coefficient [-]</p>
<p>:type diameter: float
:type height: float
:type distance: float
:type velocity: float
:type depth: float
:type depth: float
:type wac_type: str</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/flow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">wave_attenuation</span><span class="p">(</span>
    <span class="n">constants</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">velocity</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">wac_type</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wave-attenuation coefficient.</span>

<span class="sd">    :param diameter: representative coral diameter [m]</span>
<span class="sd">    :param height: coral height [m]</span>
<span class="sd">    :param distance: axial distance [m]</span>
<span class="sd">    :param velocity: flow velocity [m s-1]</span>
<span class="sd">    :param period: wave period [s]</span>
<span class="sd">    :param depth: water depth [m]</span>
<span class="sd">    :param wac_type: type of wave-attenuation coefficient [-]</span>

<span class="sd">    :type diameter: float</span>
<span class="sd">    :type height: float</span>
<span class="sd">    :type distance: float</span>
<span class="sd">    :type velocity: float</span>
<span class="sd">    :type depth: float</span>
<span class="sd">    :type depth: float</span>
<span class="sd">    :type wac_type: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Split this method in one solely focusing on the wave attenuation coefficient;</span>
    <span class="c1">#  and one implementing this method to dynamically determine the drag coefficient.</span>
    <span class="c1">#  Thus, reformat this method as in coral_model_v0.</span>
    <span class="c1"># # function and derivative definitions</span>
    <span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">beta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complex-valued function to be solved, where beta is the complex representation of the wave-attenuation</span>
<span class="sd">        coefficient.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># components</span>
        <span class="n">shear</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">8.0</span> <span class="o">*</span> <span class="n">above_motion</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">shear_length</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">beta</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">drag</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">8.0</span> <span class="o">*</span> <span class="n">above_motion</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">drag_length</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">inertia</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">((</span><span class="n">constants</span><span class="o">.</span><span class="n">Cm</span> <span class="o">*</span> <span class="n">lambda_planar</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">lambda_planar</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="c1"># combined</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">shear</span> <span class="o">+</span> <span class="n">drag</span> <span class="o">+</span> <span class="n">inertia</span>
        <span class="c1"># output</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">derivative</span><span class="p">(</span><span class="n">beta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complex-valued derivative to be used to solve the complex-valued function, where beta is the complex</span>
<span class="sd">        representation of the wave-attenuation coefficient.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># components</span>
        <span class="n">shear</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">/</span> <span class="n">shear_length</span>
        <span class="n">drag</span> <span class="o">=</span> <span class="p">(</span><span class="n">beta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span> <span class="o">/</span> <span class="n">drag_length</span>
        <span class="n">inertia</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">Cm</span> <span class="o">*</span> <span class="n">lambda_planar</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">lambda_planar</span><span class="p">)</span>
        <span class="c1"># combined</span>
        <span class="n">df</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="mf">8.0</span> <span class="o">*</span> <span class="n">above_motion</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">shear</span> <span class="o">+</span> <span class="n">drag</span><span class="p">)</span> <span class="o">+</span> <span class="n">inertia</span>
        <span class="c1"># output</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="c1"># # Input check</span>
    <span class="k">def</span> <span class="nf">wave_wac</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="n">newton</span><span class="p">(</span>
                <span class="n">function</span><span class="p">,</span>
                <span class="n">x0</span><span class="o">=</span><span class="nb">complex</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
                <span class="n">fprime</span><span class="o">=</span><span class="n">derivative</span><span class="p">,</span>
                <span class="n">maxiter</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">maxiter_aw</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">current_wac</span><span class="p">():</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">drag_length</span> <span class="o">/</span> <span class="n">shear_length</span> <span class="o">*</span> <span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="n">height</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">wac_type_funcs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">current</span><span class="o">=</span><span class="n">current_wac</span><span class="p">,</span> <span class="n">wave</span><span class="o">=</span><span class="n">wave_wac</span><span class="p">)</span>
    <span class="n">wac_function</span> <span class="o">=</span> <span class="n">wac_type_funcs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">wac_type</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">wac_function</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WAC-type (</span><span class="si">{</span><span class="n">wac_type</span><span class="si">}</span><span class="s2">) not in </span><span class="si">{</span><span class="n">wac_type_funcs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># # parameter definitions</span>
    <span class="c1"># geometric parameters</span>
    <span class="n">planar_area</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">diameter</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">frontal_area</span> <span class="o">=</span> <span class="n">diameter</span> <span class="o">*</span> <span class="n">height</span>
    <span class="n">total_area</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">distance</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">lambda_planar</span> <span class="o">=</span> <span class="n">planar_area</span> <span class="o">/</span> <span class="n">total_area</span>
    <span class="n">lambda_frontal</span> <span class="o">=</span> <span class="n">frontal_area</span> <span class="o">/</span> <span class="n">total_area</span>
    <span class="n">shear_length</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">Cs</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># # calculations</span>
    <span class="n">wac</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">&lt;=</span> <span class="n">height</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wac</span>

    <span class="c1"># If depth &gt; height</span>
    <span class="c1"># initial iteration values</span>
    <span class="n">above_flow</span> <span class="o">=</span> <span class="n">velocity</span>
    <span class="n">drag_coefficient</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="c1"># iteration</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">maxiter_k</span><span class="p">)):</span>
        <span class="n">drag_length</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">height</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_planar</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">drag_coefficient</span> <span class="o">*</span> <span class="n">lambda_frontal</span>
        <span class="p">)</span>
        <span class="n">above_motion</span> <span class="o">=</span> <span class="p">(</span><span class="n">above_flow</span> <span class="o">*</span> <span class="n">period</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">wac</span> <span class="o">=</span> <span class="n">wac_function</span><span class="p">()</span>

        <span class="n">porous_flow</span> <span class="o">=</span> <span class="n">wac</span> <span class="o">*</span> <span class="n">above_flow</span>
        <span class="n">constricted_flow</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lambda_planar</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">4</span> <span class="o">*</span> <span class="n">lambda_planar</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">psi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span>
            <span class="o">*</span> <span class="n">porous_flow</span>
        <span class="p">)</span>
        <span class="n">reynolds</span> <span class="o">=</span> <span class="p">(</span><span class="n">constricted_flow</span> <span class="o">*</span> <span class="n">diameter</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">nu</span>
        <span class="n">new_drag</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">reynolds</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">new_drag</span> <span class="o">-</span> <span class="n">drag_coefficient</span><span class="p">)</span> <span class="o">/</span> <span class="n">new_drag</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">constants</span><span class="o">.</span><span class="n">err</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">drag_coefficient</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_drag</span><span class="p">)</span>
            <span class="n">above_flow</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">constants</span><span class="o">.</span><span class="n">numericTheta</span><span class="p">)</span> <span class="o">*</span> <span class="n">above_flow</span>
                <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">numericTheta</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">depth</span> <span class="o">*</span> <span class="n">velocity</span> <span class="o">-</span> <span class="n">height</span> <span class="o">*</span> <span class="n">porous_flow</span><span class="p">)</span>
                <span class="o">/</span> <span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="n">height</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">maxiter_k</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;WARNING: maximum number of iterations reached &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">constants</span><span class="o">.</span><span class="n">maxiter_k</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">wac</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.flow.Flow.wave_current" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wave_current</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_w</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha_c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span></code>


<a href="#src.core.bio_process.flow.Flow.wave_current" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Wave-current interaction.</p>
<p>:param alpha_w: wave-attenuation coefficient, defaults to 1
:param alpha_c: current-attenuation coefficient, defaults to 1</p>
<p>:type alpha_w: float, list, tuple, numpy.ndarray, optional
:type alpha_c: float, list, tuple, numpy.ndarray, optional</p>
<p>:return: wave-current interaction
:rtype: float, numpy.ndarray</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/flow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">wave_current</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_w</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha_c</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wave-current interaction.</span>

<span class="sd">    :param alpha_w: wave-attenuation coefficient, defaults to 1</span>
<span class="sd">    :param alpha_c: current-attenuation coefficient, defaults to 1</span>

<span class="sd">    :type alpha_w: float, list, tuple, numpy.ndarray, optional</span>
<span class="sd">    :type alpha_c: float, list, tuple, numpy.ndarray, optional</span>

<span class="sd">    :return: wave-current interaction</span>
<span class="sd">    :rtype: float, numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="p">(</span><span class="n">alpha_w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">uw</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">alpha_c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">uc</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">alpha_w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">uw</span> <span class="o">*</span> <span class="n">alpha_c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">uc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">wcAngle</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>

<h3 id="light">Light<a class="headerlink" href="#light" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.light.Light" class="doc doc-heading">
        <code>Light</code>



<a href="#src.core.bio_process.light.Light" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Light micro-environment.</p>




  <div class="doc doc-children">




  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.light.Light.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">light_in</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">lac</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">depth</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pfd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_proc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Kd0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_max</span><span class="o">=</span><span class="mf">1.5707963267948966</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">Cf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wcAngle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">numericTheta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">maxiter_k</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">maxiter_aw</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">K0</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">ap</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.6089</span><span class="p">,</span> <span class="n">iota</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ik_max</span><span class="o">=</span><span class="mf">372.32</span><span class="p">,</span> <span class="n">pm_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">betaI</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span> <span class="n">betaP</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">Icomp</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Ea</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">8.31446261815324</span><span class="p">,</span> <span class="n">k_var</span><span class="o">=</span><span class="mf">2.45</span><span class="p">,</span> <span class="n">nn</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">pfd_min</span><span class="o">=</span><span class="mf">0.68886964</span><span class="p">,</span> <span class="n">ucr</span><span class="o">=</span><span class="mf">0.5173</span><span class="p">,</span> <span class="n">r_growth</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">r_recovery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">r_mortality</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">r_bleaching</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">gC</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">omegaA0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">0.14587415</span><span class="p">,</span> <span class="n">kappaA</span><span class="o">=</span><span class="mf">0.66236107</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prop_form</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_plate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">prop_plate_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space</span><span class="o">=</span><span class="mf">0.35355339059327373</span><span class="p">,</span> <span class="n">prop_space_light</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rho_c</span><span class="o">=</span><span class="mf">1600.0</span><span class="p">,</span> <span class="n">sigma_t</span><span class="o">=</span><span class="mf">200000.0</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rho_w</span><span class="o">=</span><span class="mf">1025.0</span><span class="p">,</span> <span class="n">no_larvae</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="n">prob_settle</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">d_larvae</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#src.core.bio_process.light.Light.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Light micro-environment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>light_in</code></td>
        <td><code>Union[float, list, tuple, numpy.ndarray]</code></td>
        <td><p>Incoming light-intensity at the water-air interface [u mol photons m-2 s-1]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>lac</code></td>
        <td><code>Union[float, list, tuple, numpy.ndarray]</code></td>
        <td><p>light-attenuation coefficient [m-1]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>depth</code></td>
        <td><code>Union[float, list, tuple, numpy.ndarray]</code></td>
        <td><p>water depth [m]</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>constants</code></td>
        <td><code>Constants</code></td>
        <td><p>List of constants to be used for this object.</p></td>
        <td><code>Constants(input_file=None, fme=False, tme=False, pfd=False, warn_proc=True, Kd0=0.1, theta_max=1.5707963267948966, Cs=0.17, Cm=1.7, Cf=0.01, nu=1e-06, alpha=1e-07, psi=2, wcAngle=0.0, rd=500, numericTheta=0.5, err=0.001, maxiter_k=100000, maxiter_aw=100000, K0=80.0, ap=0.4, k=0.6089, iota=0.6, ik_max=372.32, pm_max=1.0, betaI=0.34, betaP=0.09, Icomp=0.01, Ea=60000.0, R=8.31446261815324, k_var=2.45, nn=60, pfd_min=0.68886964, ucr=0.5173, r_growth=0.002, r_recovery=0.2, r_mortality=0.04, r_bleaching=8.0, gC=0.5, omegaA0=5.0, omega0=0.14587415, kappaA=0.66236107, rf=1.0, rp=1.0, prop_form=0.1, prop_plate=0.5, prop_plate_flow=0.1, prop_space=0.35355339059327373, prop_space_light=0.1, prop_space_flow=0.1, u0=0.2, rho_c=1600.0, sigma_t=200000.0, Cd=1.0, rho_w=1025.0, no_larvae=1000000.0, prob_settle=0.0001, d_larvae=0.001)</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/light.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">light_in</span><span class="p">:</span> <span class="n">LightVariable</span><span class="p">,</span>
    <span class="n">lac</span><span class="p">:</span> <span class="n">LightVariable</span><span class="p">,</span>
    <span class="n">depth</span><span class="p">:</span> <span class="n">LightVariable</span><span class="p">,</span>
    <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(),</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Light micro-environment.</span>

<span class="sd">    Args:</span>
<span class="sd">        light_in (LightVariable): Incoming light-intensity at the water-air interface [u mol photons m-2 s-1]</span>
<span class="sd">        lac (LightVariable): light-attenuation coefficient [m-1]</span>
<span class="sd">        depth (LightVariable): water depth [m]</span>
<span class="sd">        constants (Constants): List of constants to be used for this object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_reshape</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">I0</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">light_in</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">lac</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="s2">&quot;space&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.light.Light.base_light" class="doc doc-heading">
<code class="highlight language-python"><span class="n">base_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.light.Light.base_light" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Section of coral base receiving light.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/light.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">base_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Section of coral base receiving light.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># # spreading of light</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">light_spreading</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>

    <span class="c1"># # coral base section</span>
    <span class="n">base_section</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">hc_matrix</span>
        <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">tc_matrix</span>
        <span class="o">-</span> <span class="p">((</span><span class="n">coral</span><span class="o">.</span><span class="n">dc_matrix</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">bc_matrix</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">theta</span><span class="p">)))</span>
    <span class="p">)</span>
    <span class="c1"># no negative lengths</span>
    <span class="n">base_section</span><span class="p">[</span><span class="n">base_section</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">base_section</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.light.Light.biomass" class="doc doc-heading">
<code class="highlight language-python"><span class="n">biomass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.light.Light.biomass" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Coral biomass; as surface.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/light.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">biomass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Coral biomass; as surface.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_section</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_light</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">light_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mf">0.25</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">dc_matrix</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="o">+</span> <span class="n">coral</span><span class="o">.</span><span class="n">dc_matrix</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">tc_matrix</span>
        <span class="o">+</span> <span class="n">coral</span><span class="o">.</span><span class="n">bc_matrix</span> <span class="o">*</span> <span class="n">base_section</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.light.Light.light_spreading" class="doc doc-heading">
<code class="highlight language-python"><span class="n">light_spreading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.light.Light.light_spreading" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Spreading of light as function of depth.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/light.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">light_spreading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Spreading of light as function of depth.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">theta_max</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
        <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">hc_matrix</span> <span class="o">+</span> <span class="n">coral</span><span class="o">.</span><span class="n">tc_matrix</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.light.Light.rep_light" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rep_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.light.Light.rep_light" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Representative light-intensity.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/light.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rep_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Representative light-intensity.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_section</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_light</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>
    <span class="c1"># # light catchment per coral section</span>
    <span class="c1"># top of plate</span>
    <span class="n">top</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">0.25</span>
        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">dc_matrix</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I0</span>
        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">hc_matrix</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="c1"># side of plate</span>
    <span class="n">side</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">dc_matrix</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I0</span><span class="p">)</span>
        <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kd</span>
        <span class="o">*</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">hc_matrix</span><span class="p">))</span>
            <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">hc_matrix</span> <span class="o">+</span> <span class="n">coral</span><span class="o">.</span><span class="n">tc_matrix</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">side_correction</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># side of base</span>
    <span class="n">base</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">bc_matrix</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I0</span><span class="p">)</span>
        <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Kd</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">base_section</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">))</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">side_correction</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># total</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">top</span> <span class="o">+</span> <span class="n">side</span> <span class="o">+</span> <span class="n">base</span>

    <span class="c1"># # biomass-averaged</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">biomass</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">averaged_light</span><span class="p">(</span><span class="n">total_light</span><span class="p">,</span> <span class="n">biomass</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Averaged light-intensity.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">total_light</span> <span class="o">/</span> <span class="n">biomass</span>

    <span class="n">coral</span><span class="o">.</span><span class="n">light</span> <span class="o">=</span> <span class="n">CoralOnly</span><span class="p">()</span><span class="o">.</span><span class="n">in_spacetime</span><span class="p">(</span>
        <span class="n">coral</span><span class="o">=</span><span class="n">coral</span><span class="p">,</span>
        <span class="n">function</span><span class="o">=</span><span class="n">averaged_light</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">coral</span><span class="o">.</span><span class="n">light_bc</span><span class="p">),</span>
        <span class="n">no_cover_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">I0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.light.Light.side_correction" class="doc doc-heading">
<code class="highlight language-python"><span class="n">side_correction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.light.Light.side_correction" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Correction of the light-intensity on the sides of the coral object.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/light.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">side_correction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Correction of the light-intensity on the sides of the coral object.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># # spreading of light</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">light_spreading</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>

    <span class="c1"># # correction factor</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">theta</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>








  </div>

    </div>

  </div>

<h3 id="morphology">Morphology<a class="headerlink" href="#morphology" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.morphology.Morphology" class="doc doc-heading">
        <code>Morphology</code>



<a href="#src.core.bio_process.morphology.Morphology" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Morphological development.</p>




  <div class="doc doc-children">




  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.morphology.Morphology.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calc_sum</span><span class="p">,</span> <span class="n">light_in</span><span class="p">,</span> <span class="n">dt_year</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pfd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_proc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Kd0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_max</span><span class="o">=</span><span class="mf">1.5707963267948966</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">Cf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wcAngle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">numericTheta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">maxiter_k</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">maxiter_aw</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">K0</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">ap</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.6089</span><span class="p">,</span> <span class="n">iota</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ik_max</span><span class="o">=</span><span class="mf">372.32</span><span class="p">,</span> <span class="n">pm_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">betaI</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span> <span class="n">betaP</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">Icomp</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Ea</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">8.31446261815324</span><span class="p">,</span> <span class="n">k_var</span><span class="o">=</span><span class="mf">2.45</span><span class="p">,</span> <span class="n">nn</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">pfd_min</span><span class="o">=</span><span class="mf">0.68886964</span><span class="p">,</span> <span class="n">ucr</span><span class="o">=</span><span class="mf">0.5173</span><span class="p">,</span> <span class="n">r_growth</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">r_recovery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">r_mortality</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">r_bleaching</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">gC</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">omegaA0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">0.14587415</span><span class="p">,</span> <span class="n">kappaA</span><span class="o">=</span><span class="mf">0.66236107</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prop_form</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_plate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">prop_plate_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space</span><span class="o">=</span><span class="mf">0.35355339059327373</span><span class="p">,</span> <span class="n">prop_space_light</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rho_c</span><span class="o">=</span><span class="mf">1600.0</span><span class="p">,</span> <span class="n">sigma_t</span><span class="o">=</span><span class="mf">200000.0</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rho_w</span><span class="o">=</span><span class="mf">1025.0</span><span class="p">,</span> <span class="n">no_larvae</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="n">prob_settle</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">d_larvae</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#src.core.bio_process.morphology.Morphology.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Morphological development.</p>
<p>:param calc_sum: accumulation of calcification of :param dt_year: years [kg m-2 yr-1]
:param light_in: incoming light-intensity at water-air interface [umol photons m-2 s-1]
:param dt_year: update interval [yr], defaults to 1</p>
<p>:type calc_sum: float, int, list, tuple, numpy.ndarray
:type light_in: float, int, list, tuple, numpy.ndarray
:type dt_year: float, int</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/morphology.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">calc_sum</span><span class="p">,</span> <span class="n">light_in</span><span class="p">,</span> <span class="n">dt_year</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">()</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Morphological development.</span>

<span class="sd">    :param calc_sum: accumulation of calcification of :param dt_year: years [kg m-2 yr-1]</span>
<span class="sd">    :param light_in: incoming light-intensity at water-air interface [umol photons m-2 s-1]</span>
<span class="sd">    :param dt_year: update interval [yr], defaults to 1</span>

<span class="sd">    :type calc_sum: float, int, list, tuple, numpy.ndarray</span>
<span class="sd">    :type light_in: float, int, list, tuple, numpy.ndarray</span>
<span class="sd">    :type dt_year: float, int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_reshape</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">calc_sum</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_sum</span> <span class="o">=</span> <span class="n">calc_sum</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_sum</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">matrix2array</span><span class="p">(</span><span class="n">calc_sum</span><span class="p">,</span> <span class="s2">&quot;space&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dt_year</span> <span class="o">=</span> <span class="n">dt_year</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">I0</span> <span class="o">=</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">light_in</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vol_increase</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.morphology.Morphology.delta_volume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delta_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.morphology.Morphology.delta_volume" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>:param coral: coral object
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/morphology.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">delta_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param coral: coral object</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vol_increase</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">0.5</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">ac</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_sum</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt_year</span>
        <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">rho_c</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">light_bc</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_increase</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.morphology.Morphology.ratio_update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ratio_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span></code>


<a href="#src.core.bio_process.morphology.Morphology.ratio_update" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>:param coral: coral object
:param ratio: morphological ratio to update</p>
<p>:type coral: Coral
:type ratio: str</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/morphology.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ratio_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">ratio</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param coral: coral object</span>
<span class="sd">    :param ratio: morphological ratio to update</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type ratio: str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># partial differential equation - mass balance</span>
    <span class="k">def</span> <span class="nf">mass_balance</span><span class="p">(</span><span class="n">r_old</span><span class="p">,</span> <span class="n">r_opt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Mass balance.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">volume</span> <span class="o">*</span> <span class="n">r_old</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_increase</span> <span class="o">*</span> <span class="n">r_opt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">coral</span><span class="o">.</span><span class="n">volume</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_increase</span>
        <span class="p">)</span>

    <span class="c1"># input check</span>
    <span class="n">ratios</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;rf&quot;</span><span class="p">,</span> <span class="s2">&quot;rp&quot;</span><span class="p">,</span> <span class="s2">&quot;rs&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ratio</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ratios</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="n">ratios</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># calculations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delta_volume</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>

    <span class="c1"># optimal ratio</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2">_optimal&quot;</span><span class="p">,</span> <span class="n">coral</span><span class="p">)</span>

    <span class="c1"># update morphological ratio</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2">_optimal&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">coral</span><span class="p">,</span> <span class="n">ratio</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mass_balance</span><span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">coral</span><span class="p">,</span> <span class="n">ratio</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2">_optimal&quot;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-attribute">



<h4 id="src.core.bio_process.morphology.Morphology.rf_optimal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rf_optimal</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-writable"><code>writable</code></small>
  </span>

<a href="#src.core.bio_process.morphology.Morphology.rf_optimal" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Optimal form ratio; height-to-plate diameter.</p>
<p>:rtype: float, numpy.ndarray</p>
    </div>

  </div>





  <div class="doc doc-object doc-attribute">



<h4 id="src.core.bio_process.morphology.Morphology.rp_optimal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rp_optimal</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-writable"><code>writable</code></small>
  </span>

<a href="#src.core.bio_process.morphology.Morphology.rp_optimal" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Optimal plate ratio; base diameter-to-plate diameter.</p>
<p>:rtype: float, numpy.ndarray</p>
    </div>

  </div>





  <div class="doc doc-object doc-attribute">



<h4 id="src.core.bio_process.morphology.Morphology.rs_optimal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rs_optimal</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-writable"><code>writable</code></small>
  </span>

<a href="#src.core.bio_process.morphology.Morphology.rs_optimal" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Optimal spacing ratio; plate diameter-to-axial distance.</p>
<p>:rtype: float, numpy.ndarray</p>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.morphology.Morphology.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.morphology.Morphology.update" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Update morphology.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/morphology.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update morphology.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># # calculations</span>
    <span class="c1"># updated ratios</span>
    <span class="n">ratios</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">ratio</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio_update</span><span class="p">(</span><span class="n">coral</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="k">for</span> <span class="n">ratio</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;rf&quot;</span><span class="p">,</span> <span class="s2">&quot;rp&quot;</span><span class="p">,</span> <span class="s2">&quot;rs&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># updated volume</span>
    <span class="n">volume</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">volume</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_increase</span>

    <span class="c1"># update coral morphology</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">update_coral_morphology</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">ratios</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>

<h3 id="photosynthesis">Photosynthesis<a class="headerlink" href="#photosynthesis" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.photosynthesis.Photosynthesis" class="doc doc-heading">
        <code>Photosynthesis</code>



<a href="#src.core.bio_process.photosynthesis.Photosynthesis" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Photosynthesis.</p>




  <div class="doc doc-children">




  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.photosynthesis.Photosynthesis.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">light_in</span><span class="p">,</span> <span class="n">first_year</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pfd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_proc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Kd0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_max</span><span class="o">=</span><span class="mf">1.5707963267948966</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">Cf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wcAngle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">numericTheta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">maxiter_k</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">maxiter_aw</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">K0</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">ap</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.6089</span><span class="p">,</span> <span class="n">iota</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ik_max</span><span class="o">=</span><span class="mf">372.32</span><span class="p">,</span> <span class="n">pm_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">betaI</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span> <span class="n">betaP</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">Icomp</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Ea</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">8.31446261815324</span><span class="p">,</span> <span class="n">k_var</span><span class="o">=</span><span class="mf">2.45</span><span class="p">,</span> <span class="n">nn</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">pfd_min</span><span class="o">=</span><span class="mf">0.68886964</span><span class="p">,</span> <span class="n">ucr</span><span class="o">=</span><span class="mf">0.5173</span><span class="p">,</span> <span class="n">r_growth</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">r_recovery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">r_mortality</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">r_bleaching</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">gC</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">omegaA0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">0.14587415</span><span class="p">,</span> <span class="n">kappaA</span><span class="o">=</span><span class="mf">0.66236107</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prop_form</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_plate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">prop_plate_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space</span><span class="o">=</span><span class="mf">0.35355339059327373</span><span class="p">,</span> <span class="n">prop_space_light</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rho_c</span><span class="o">=</span><span class="mf">1600.0</span><span class="p">,</span> <span class="n">sigma_t</span><span class="o">=</span><span class="mf">200000.0</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rho_w</span><span class="o">=</span><span class="mf">1025.0</span><span class="p">,</span> <span class="n">no_larvae</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="n">prob_settle</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">d_larvae</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#src.core.bio_process.photosynthesis.Photosynthesis.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Photosynthetic efficiency based on photosynthetic dependencies.</p>
<p>:param light_in: incoming light-intensity at the water-air interface [umol photons m-2 s-1]
:param first_year: first year of the model simulation</p>
<p>:type light_in: float, list, tuple, numpy.ndarray
:type first_year: bool</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/photosynthesis.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">light_in</span><span class="p">,</span> <span class="n">first_year</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Photosynthetic efficiency based on photosynthetic dependencies.</span>

<span class="sd">    :param light_in: incoming light-intensity at the water-air interface [umol photons m-2 s-1]</span>
<span class="sd">    :param first_year: first year of the model simulation</span>

<span class="sd">    :type light_in: float, list, tuple, numpy.ndarray</span>
<span class="sd">    :type first_year: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">I0</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">light_in</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first_year</span> <span class="o">=</span> <span class="n">first_year</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pld</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ptd</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pfd</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.photosynthesis.Photosynthesis.flow_dependency" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flow_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.photosynthesis.Photosynthesis.flow_dependency" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Photosynthetic flow dependency.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/photosynthesis.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">flow_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Photosynthetic flow dependency.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">pfd</span><span class="p">:</span>
        <span class="n">pfd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">pfd_min</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">pfd_min</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">ucm</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">ucr</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pfd</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">pfd</span><span class="p">,</span> <span class="s2">&quot;space&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pfd</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.photosynthesis.Photosynthesis.light_dependency" class="doc doc-heading">
<code class="highlight language-python"><span class="n">light_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span></code>


<a href="#src.core.bio_process.photosynthesis.Photosynthesis.light_dependency" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Photosynthetic light dependency.</p>
<p>:param coral: coral animal
:param output: type of output</p>
<p>:type coral: Coral
:type output: str</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/photosynthesis.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">light_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Photosynthetic light dependency.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param output: type of output</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type output: str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">photo_acclimation</span><span class="p">(</span><span class="n">x_old</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Photo-acclimation.&quot;&quot;&quot;</span>
        <span class="c1"># input check</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Ik&quot;</span><span class="p">,</span> <span class="s2">&quot;Pmax&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="c1"># parameter definitions</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">ik_max</span> <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;Ik&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">pm_max</span>
        <span class="n">beta_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">betaI</span> <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;Ik&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">betaP</span>

        <span class="c1"># calculations</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">x_max</span> <span class="o">*</span> <span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">light</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">I0</span><span class="p">)</span> <span class="o">**</span> <span class="n">beta_x</span>
        <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;qss&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">xs</span>
        <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;new&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">xs</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_old</span> <span class="o">-</span> <span class="n">xs</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">iota</span><span class="p">)</span>

    <span class="c1"># # parameter definitions</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;qss&quot;</span><span class="p">:</span>
        <span class="n">ik</span> <span class="o">=</span> <span class="n">photo_acclimation</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Ik&quot;</span><span class="p">)</span>
        <span class="n">p_max</span> <span class="o">=</span> <span class="n">photo_acclimation</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Pmax&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Only the quasi-steady state solution is currently implemented; use key-word &#39;qss&#39;.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># # calculations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pld</span> <span class="o">=</span> <span class="n">p_max</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">light</span> <span class="o">/</span> <span class="n">ik</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Icomp</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">I0</span> <span class="o">/</span> <span class="n">ik</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.photosynthesis.Photosynthesis.photo_rate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">photo_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">environment</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span></code>


<a href="#src.core.bio_process.photosynthesis.Photosynthesis.photo_rate" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Photosynthetic efficiency.</p>
<p>:param coral: coral animal
:param environment: environmental conditions
:param year: year of simulation</p>
<p>:type coral: Coral
:type environment: Environment
:type year: int</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/photosynthesis.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">photo_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="n">environment</span><span class="p">,</span> <span class="n">year</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Photosynthetic efficiency.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param environment: environmental conditions</span>
<span class="sd">    :param year: year of simulation</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type environment: Environment</span>
<span class="sd">    :type year: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># components</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">light_dependency</span><span class="p">(</span><span class="n">coral</span><span class="p">,</span> <span class="s2">&quot;qss&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">thermal_dependency</span><span class="p">(</span><span class="n">coral</span><span class="p">,</span> <span class="n">environment</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flow_dependency</span><span class="p">(</span><span class="n">coral</span><span class="p">)</span>

    <span class="c1"># combined</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">photo_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pld</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptd</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pfd</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.photosynthesis.Photosynthesis.thermal_dependency" class="doc doc-heading">
<code class="highlight language-python"><span class="n">thermal_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span></code>


<a href="#src.core.bio_process.photosynthesis.Photosynthesis.thermal_dependency" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Photosynthetic thermal dependency.</p>
<p>:param coral: coral animal
:param env: environmental conditions
:param year: year of simulation</p>
<p>:type coral: Coral
:type env: Environment
:type year: int</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/photosynthesis.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">thermal_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">year</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Photosynthetic thermal dependency.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param env: environmental conditions</span>
<span class="sd">    :param year: year of simulation</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type env: Environment</span>
<span class="sd">    :type year: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_reshape</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">thermal_acc</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Thermal-acclimation.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">tme</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_year</span><span class="p">:</span>
                <span class="n">env</span><span class="o">.</span><span class="n">tmeMMMmin</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">env</span><span class="o">.</span><span class="n">temp_mmm</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">space</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">_reshape</span><span class="o">.</span><span class="n">space</span><span class="p">)],</span>
                    <span class="p">)</span>
                    <span class="o">+</span> <span class="n">coral</span><span class="o">.</span><span class="n">dTc</span>
                <span class="p">)</span>
                <span class="n">env</span><span class="o">.</span><span class="n">tmeMMMmax</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">env</span><span class="o">.</span><span class="n">temp_mmm</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">_reshape</span><span class="o">.</span><span class="n">space</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">_reshape</span><span class="o">.</span><span class="n">space</span><span class="p">)],</span>
                    <span class="p">)</span>
                    <span class="o">+</span> <span class="n">coral</span><span class="o">.</span><span class="n">dTc</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">env</span><span class="o">.</span><span class="n">tmeMMMmin</span><span class="p">[</span><span class="n">env</span><span class="o">.</span><span class="n">tmeMMM</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span> <span class="o">+=</span> <span class="n">coral</span><span class="o">.</span><span class="n">dTc</span>
                <span class="n">env</span><span class="o">.</span><span class="n">tmeMMMmax</span><span class="p">[</span><span class="n">env</span><span class="o">.</span><span class="n">tmeMMm</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span> <span class="o">+=</span> <span class="n">coral</span><span class="o">.</span><span class="n">dTc</span>

            <span class="n">mmm_min</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmeMMMmin</span><span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">tmeMMM</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">year</span><span class="p">,</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">tmeMMM</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">year</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">nn</span> <span class="o">/</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">]</span>
            <span class="n">m_min</span> <span class="o">=</span> <span class="n">mmm_min</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">s_min</span> <span class="o">=</span> <span class="n">mmm_min</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">mmm_max</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmeMMMmax</span><span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">tmeMMM</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">year</span><span class="p">,</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">tmeMMM</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">year</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">nn</span> <span class="o">/</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">]</span>
            <span class="n">m_max</span> <span class="o">=</span> <span class="n">mmm_max</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">s_max</span> <span class="o">=</span> <span class="n">mmm_max</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mmm</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">temp_mmm</span><span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">temp_mmm</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">year</span><span class="p">,</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">temp_mmm</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">year</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">nn</span> <span class="o">/</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">]</span>
            <span class="n">m_min</span><span class="p">,</span> <span class="n">m_max</span> <span class="o">=</span> <span class="n">mmm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">s_min</span><span class="p">,</span> <span class="n">s_max</span> <span class="o">=</span> <span class="n">mmm</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">coral</span><span class="o">.</span><span class="n">Tlo</span> <span class="o">=</span> <span class="n">m_min</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">k_var</span> <span class="o">*</span> <span class="n">s_min</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">Thi</span> <span class="o">=</span> <span class="n">m_max</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">k_var</span> <span class="o">*</span> <span class="n">s_max</span>

    <span class="k">def</span> <span class="nf">adapted_temp</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Adapted temperature response.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">spec</span><span class="p">():</span>
            <span class="sd">&quot;&quot;&quot;Specialisation term.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="mf">4e-4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.33</span> <span class="o">*</span> <span class="p">(</span><span class="n">delta_temp</span> <span class="o">-</span> <span class="mi">10</span><span class="p">))</span>

        <span class="n">response</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">Tlo</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">Tlo</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">delta_temp</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span>
        <span class="n">temp_cr</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">Tlo</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_temp</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">tme</span><span class="p">:</span>
                <span class="n">response</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">&lt;=</span> <span class="n">temp_cr</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span>
                    <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="o">*</span> <span class="n">delta_temp</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">&lt;=</span> <span class="n">temp_cr</span><span class="p">]</span> <span class="o">**</span> <span class="mi">3</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">&lt;=</span> <span class="n">temp_cr</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span>
                    <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="o">*</span> <span class="n">delta_temp</span> <span class="o">**</span> <span class="mi">3</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">&lt;=</span> <span class="n">temp_cr</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="o">*</span> <span class="n">delta_temp</span> <span class="o">**</span> <span class="mi">3</span>

        <span class="k">return</span> <span class="n">response</span> <span class="o">*</span> <span class="n">spec</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">thermal_env</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Thermal envelope.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">Ea</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">300</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">temp_opt</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># # parameter definitions</span>
    <span class="n">thermal_acc</span><span class="p">()</span>
    <span class="n">delta_temp</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">Thi</span> <span class="o">-</span> <span class="n">coral</span><span class="o">.</span><span class="n">Tlo</span>
    <span class="n">temp_opt</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">Tlo</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">delta_temp</span>

    <span class="c1"># # calculations</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">adapted_temp</span><span class="p">()</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">thermal_env</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ptd</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">f2</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>

<h3 id="population-states">Population states<a class="headerlink" href="#population-states" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.population_states.PopulationStates" class="doc doc-heading">
        <code>PopulationStates</code>



<a href="#src.core.bio_process.population_states.PopulationStates" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Bleaching response following the population dynamics.</p>




  <div class="doc doc-children">




  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.population_states.PopulationStates.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pfd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_proc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Kd0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_max</span><span class="o">=</span><span class="mf">1.5707963267948966</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">Cf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wcAngle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">numericTheta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">maxiter_k</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">maxiter_aw</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">K0</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">ap</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.6089</span><span class="p">,</span> <span class="n">iota</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ik_max</span><span class="o">=</span><span class="mf">372.32</span><span class="p">,</span> <span class="n">pm_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">betaI</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span> <span class="n">betaP</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">Icomp</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Ea</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">8.31446261815324</span><span class="p">,</span> <span class="n">k_var</span><span class="o">=</span><span class="mf">2.45</span><span class="p">,</span> <span class="n">nn</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">pfd_min</span><span class="o">=</span><span class="mf">0.68886964</span><span class="p">,</span> <span class="n">ucr</span><span class="o">=</span><span class="mf">0.5173</span><span class="p">,</span> <span class="n">r_growth</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">r_recovery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">r_mortality</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">r_bleaching</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">gC</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">omegaA0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">0.14587415</span><span class="p">,</span> <span class="n">kappaA</span><span class="o">=</span><span class="mf">0.66236107</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prop_form</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_plate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">prop_plate_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space</span><span class="o">=</span><span class="mf">0.35355339059327373</span><span class="p">,</span> <span class="n">prop_space_light</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rho_c</span><span class="o">=</span><span class="mf">1600.0</span><span class="p">,</span> <span class="n">sigma_t</span><span class="o">=</span><span class="mf">200000.0</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rho_w</span><span class="o">=</span><span class="mf">1025.0</span><span class="p">,</span> <span class="n">no_larvae</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="n">prob_settle</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">d_larvae</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">dt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#src.core.bio_process.population_states.PopulationStates.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Population dynamics.</p>
<p>:param dt: time step [yrs], defaults to one
:type dt: float, optional</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/population_states.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(),</span> <span class="n">dt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Population dynamics.</span>

<span class="sd">    :param dt: time step [yrs], defaults to one</span>
<span class="sd">    :type dt: float, optional</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.population_states.PopulationStates.pop_states_t" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pop_states_t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.population_states.PopulationStates.pop_states_t" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Population dynamics over time.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/population_states.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pop_states_t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Population dynamics over time.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_reshape</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">pop_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="n">_reshape</span><span class="o">.</span><span class="n">spacetime</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_reshape</span><span class="o">.</span><span class="n">time</span><span class="p">):</span>
        <span class="n">photosynthesis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">_reshape</span><span class="o">.</span><span class="n">space</span><span class="p">)</span>
        <span class="n">photosynthesis</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">cover</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">photo_rate</span><span class="p">[</span>
            <span class="n">coral</span><span class="o">.</span><span class="n">cover</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">n</span>
        <span class="p">]</span>  <span class="c1"># 21_09 have changed coral.cover&gt;0 to .0.</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">pop_states</span><span class="p">[:,</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_states_xy</span><span class="p">(</span><span class="n">coral</span><span class="p">,</span> <span class="n">photosynthesis</span><span class="p">)</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">cover</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">pop_states</span><span class="p">[</span><span class="n">coral</span><span class="o">.</span><span class="n">cover</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.population_states.PopulationStates.pop_states_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pop_states_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">ps</span><span class="p">)</span></code>


<a href="#src.core.bio_process.population_states.PopulationStates.pop_states_xy" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Population dynamics over space.</p>
<p>:param coral: coral animal
:param ps: photosynthetic rate</p>
<p>:type coral: Coral
:type ps: numpy.ndarray</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/population_states.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pop_states_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">ps</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Population dynamics over space.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param ps: photosynthetic rate</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type ps: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">space</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="c1"># # calculations</span>
    <span class="c1"># growing conditions</span>
    <span class="c1"># &gt; bleached pop.      # ps&gt;0. here represents ps&gt;tsh that is the value of the bleaching treshold light and 1. where 1.0 is a number, not column reference</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mi">1</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="o">*</span> <span class="p">(</span>
            <span class="mf">8.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_recovery</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">/</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_mortality</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># &gt; pale pop.</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="o">+</span> <span class="p">(</span><span class="mf">8.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_recovery</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">/</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_recovery</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span><span class="p">)</span>
    <span class="c1"># &gt; recovering pop.</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_recovery</span>
        <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
        <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_recovery</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span><span class="p">)</span>
    <span class="c1"># &gt; healthy pop.</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_growth</span>
        <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
        <span class="o">/</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_growth</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mf">1.0</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="o">+</span> <span class="mf">0.5</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_recovery</span>
        <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
        <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>

    <span class="c1"># bleaching conditions</span>
    <span class="c1"># &gt; healthy pop.</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_bleaching</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
    <span class="p">)</span>
    <span class="c1"># &gt; recovering pop.</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_bleaching</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
    <span class="p">)</span>
    <span class="c1"># &gt; pale pop.</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_bleaching</span>
        <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_bleaching</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
    <span class="p">)</span>
    <span class="c1"># &gt; bleached pop.</span>
    <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="o">-</span> <span class="mf">0.5</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_bleaching</span>
        <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
        <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mf">1.0</span>
        <span class="o">-</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">r_bleaching</span> <span class="o">*</span> <span class="n">ps</span><span class="p">[</span><span class="n">ps</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">Csp</span>
    <span class="p">)</span>

    <span class="c1"># # check on carrying capacity</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0001</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">):</span>
        <span class="n">slot_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">))[</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0001</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">]</span>
        <span class="n">slot_2</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0001</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">]</span>
        <span class="n">slot_3</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0001</span> <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;WARNING: Total population than carrying capacity at </span><span class="si">{</span><span class="n">slot_1</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">PT = </span><span class="si">{</span><span class="n">slot_2</span><span class="si">}</span><span class="s2">; K = </span><span class="si">{</span><span class="n">slot_3</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># # output</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>

<h3 id="recruitment">Recruitment<a class="headerlink" href="#recruitment" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.recruitment.Recruitment" class="doc doc-heading">
        <code>Recruitment</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a href="#src.core.bio_process.recruitment.Recruitment" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Recruitment dynamics.</p>




  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.recruitment.Recruitment.recruited" class="doc doc-heading">
<code class="highlight language-python"><span class="n">recruited</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">averaged_healthy_pop</span><span class="p">,</span> <span class="n">cover_real</span><span class="p">,</span> <span class="n">cover_potential</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#src.core.bio_process.recruitment.Recruitment.recruited" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Determination of recruitment.</p>
<p>:param potential: recruitment potential
:param averaged_healthy_pop: model domain averaged healthy population
:param cover_real: real coral cover
:param cover_potential: potential coral cover</p>
<p>:type potential: float
:type averaged_healthy_pop: float
:type cover_real: float
:type cover_potential: float</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/recruitment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">recruited</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">averaged_healthy_pop</span><span class="p">,</span> <span class="n">cover_real</span><span class="p">,</span> <span class="n">cover_potential</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determination of recruitment.</span>

<span class="sd">    :param potential: recruitment potential</span>
<span class="sd">    :param averaged_healthy_pop: model domain averaged healthy population</span>
<span class="sd">    :param cover_real: real coral cover</span>
<span class="sd">    :param cover_potential: potential coral cover</span>

<span class="sd">    :type potential: float</span>
<span class="sd">    :type averaged_healthy_pop: float</span>
<span class="sd">    :type cover_real: float</span>
<span class="sd">    :type cover_potential: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">potential</span> <span class="o">*</span> <span class="n">averaged_healthy_pop</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cover_real</span> <span class="o">/</span> <span class="n">cover_potential</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.recruitment.Recruitment.spawning" class="doc doc-heading">
<code class="highlight language-python"><span class="n">spawning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span></code>


<a href="#src.core.bio_process.recruitment.Recruitment.spawning" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Contribution due to mass coral spawning.</p>
<p>:param coral: coral animal
:param param: parameter type to which the spawning is added</p>
<p>:type coral: Coral
:type param: str</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/recruitment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">spawning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Contribution due to mass coral spawning.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :param param: parameter type to which the spawning is added</span>

<span class="sd">    :type coral: Coral</span>
<span class="sd">    :type param: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># # input check</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># # calculations</span>
    <span class="c1"># potential</span>
    <span class="n">power</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;P&quot;</span> <span class="k">else</span> <span class="mi">3</span>
    <span class="n">potential</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">prob_settle</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">no_larvae</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">d_larvae</span> <span class="o">**</span> <span class="n">power</span>
    <span class="p">)</span>
    <span class="c1"># recruitment</span>
    <span class="n">averaged_healthy_pop</span> <span class="o">=</span> <span class="n">coral</span><span class="o">.</span><span class="n">pop_states</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="c1"># living cover</span>
    <span class="n">living_cover</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">matrix2array</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">living_cover</span><span class="p">,</span> <span class="s2">&quot;space&quot;</span><span class="p">)</span>

    <span class="n">recruited</span> <span class="o">=</span> <span class="n">CoralOnly</span><span class="p">()</span><span class="o">.</span><span class="n">in_space</span><span class="p">(</span>
        <span class="n">coral</span><span class="o">=</span><span class="n">coral</span><span class="p">,</span>
        <span class="n">function</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recruited</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">averaged_healthy_pop</span><span class="p">,</span> <span class="n">living_cover</span><span class="p">,</span> <span class="n">coral</span><span class="o">.</span><span class="n">cover</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># # output</span>
    <span class="k">return</span> <span class="n">recruited</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.recruitment.Recruitment.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.recruitment.Recruitment.update" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Update coral cover / volume after spawning event.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/recruitment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update coral cover / volume after spawning event.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">p0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Recruitment</span><span class="o">.</span><span class="n">spawning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">)</span>
    <span class="n">coral</span><span class="o">.</span><span class="n">update_coral_volume</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">volume</span> <span class="o">+</span> <span class="n">Recruitment</span><span class="o">.</span><span class="n">spawning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>

<h3 id="temperature">Temperature<a class="headerlink" href="#temperature" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">




  <div class="doc doc-children">




  <div class="doc doc-object doc-class">



<h3 id="src.core.bio_process.temperature.Temperature" class="doc doc-heading">
        <code>Temperature</code>



<a href="#src.core.bio_process.temperature.Temperature" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">





  <div class="doc doc-children">




  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.temperature.Temperature.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">(</span><span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tme</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pfd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_proc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Kd0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_max</span><span class="o">=</span><span class="mf">1.5707963267948966</span><span class="p">,</span> <span class="n">Cs</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">Cf</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span> <span class="n">psi</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">wcAngle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rd</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">numericTheta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">maxiter_k</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">maxiter_aw</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">K0</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">ap</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.6089</span><span class="p">,</span> <span class="n">iota</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ik_max</span><span class="o">=</span><span class="mf">372.32</span><span class="p">,</span> <span class="n">pm_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">betaI</span><span class="o">=</span><span class="mf">0.34</span><span class="p">,</span> <span class="n">betaP</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span> <span class="n">Icomp</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Ea</span><span class="o">=</span><span class="mf">60000.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">8.31446261815324</span><span class="p">,</span> <span class="n">k_var</span><span class="o">=</span><span class="mf">2.45</span><span class="p">,</span> <span class="n">nn</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">pfd_min</span><span class="o">=</span><span class="mf">0.68886964</span><span class="p">,</span> <span class="n">ucr</span><span class="o">=</span><span class="mf">0.5173</span><span class="p">,</span> <span class="n">r_growth</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">r_recovery</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">r_mortality</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">r_bleaching</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">gC</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">omegaA0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">omega0</span><span class="o">=</span><span class="mf">0.14587415</span><span class="p">,</span> <span class="n">kappaA</span><span class="o">=</span><span class="mf">0.66236107</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">prop_form</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_plate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">prop_plate_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space</span><span class="o">=</span><span class="mf">0.35355339059327373</span><span class="p">,</span> <span class="n">prop_space_light</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prop_space_flow</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">u0</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rho_c</span><span class="o">=</span><span class="mf">1600.0</span><span class="p">,</span> <span class="n">sigma_t</span><span class="o">=</span><span class="mf">200000.0</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rho_w</span><span class="o">=</span><span class="mf">1025.0</span><span class="p">,</span> <span class="n">no_larvae</span><span class="o">=</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="n">prob_settle</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">d_larvae</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#src.core.bio_process.temperature.Temperature.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Thermal micro-environment.</p>
<h6 id="src.core.bio_process.temperature.Temperature.__init__--parameters">Parameters<a class="headerlink" href="#src.core.bio_process.temperature.Temperature.__init__--parameters" title="Permanent link">&para;</a></h6>
<p>temperature : numeric
    Temperature of water [K].</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/temperature.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">constants</span><span class="p">:</span> <span class="n">Constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thermal micro-environment.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    temperature : numeric</span>
<span class="sd">        Temperature of water [K].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">constants</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h4 id="src.core.bio_process.temperature.Temperature.coral_temperature" class="doc doc-heading">
<code class="highlight language-python"><span class="n">coral_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">)</span></code>


<a href="#src.core.bio_process.temperature.Temperature.coral_temperature" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Coral temperature.</p>
<p>:param coral: coral animal
:type coral: Coral</p>

        <details class="quote">
          <summary>Source code in <code>src/core/bio_process/temperature.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">coral_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coral</span><span class="p">:</span> <span class="n">Coral</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Coral temperature.</span>

<span class="sd">    :param coral: coral animal</span>
<span class="sd">    :type coral: Coral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">tme</span><span class="p">:</span>
        <span class="n">delta_t</span> <span class="o">=</span> <span class="n">RESHAPE</span><span class="p">()</span><span class="o">.</span><span class="n">variable2matrix</span><span class="p">(</span><span class="n">coral</span><span class="o">.</span><span class="n">delta_t</span><span class="p">,</span> <span class="s2">&quot;space&quot;</span><span class="p">)</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">dTc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">delta_t</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">ap</span><span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">k</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">K0</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">coral</span><span class="o">.</span><span class="n">light</span>
        <span class="p">)</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">coral</span><span class="o">.</span><span class="n">dTc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coral</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../core/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Core" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Core
            </div>
          </div>
        </a>
      
      
        
        <a href="../../common/common/" class="md-footer__link md-footer__link--next" aria-label="Next: Common" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Common
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 Deltares
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/Deltares/NBSDynamics" target="_blank" rel="noopener" title="Source code" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>